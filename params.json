{"name":"Active Importer","tagline":"Define importers that load tabular data from spreadsheets or CSV files into any ActiveRecord-like ORM.","body":"Importers are classes that you can instruct on how to import data into data models.\r\n\r\n```ruby\r\nclass EmployeeImporter < ActiveImporter::Base\r\n  imports Employee\r\n\r\n  fetch_model do\r\n    Employee.where({\r\n      first_name: row['First name'],\r\n      last_name: row['Last name'],\r\n    }).first_or_initialize\r\n  end\r\n\r\n  column 'First name', :first_name\r\n\r\n  column 'Last name', :last_name\r\n\r\n  column 'Department', :department do |department_name|\r\n    Department.find_by(name: department_name)\r\n  end\r\n\r\n  column 'Salary', :salary, optional: true\r\n\r\n  on :row_error do |ex|\r\n    logger.error(\"Couldn't import row #{row_index}: #{ex.message}\")\r\n  end\r\n\r\n  on :row_processing do\r\n    model.owner_id = params[:owner_id]\r\n  end\r\n\r\n  private\r\n\r\n  def logger\r\n    @logger ||= Rails.logger\r\n  end\r\nend\r\n```\r\n\r\nOnce defined, importers can be invoked to import a given data file.\r\n\r\n```ruby\r\nEmployeeImporter.import('file.xls', params: { owner_id: @user.id })\r\n```\r\n\r\n## Documentation\r\n\r\nFor mote detailed information about the different aspects of importing data with active_importer, refer to the following sections in the [wiki](https://github.com/continuum/active_importer/wiki).\r\n\r\n### Getting started\r\n\r\n* [Understanding how spreadsheets are parsed](https://github.com/continuum/active_importer/wiki/Understanding-how-spreadsheets-are-parsed)\r\n* [Mapping columns to attributes](https://github.com/continuum/active_importer/wiki/Mapping-columns-to-attributes)\r\n\r\n### Diving in\r\n\r\n* [Custom data processing](https://github.com/continuum/active_importer/wiki/Custom-data-processing)\r\n* [Helper methods](https://github.com/continuum/active_importer/wiki/Helper-methods)\r\n* [File extension and supported formats](https://github.com/continuum/active_importer/wiki/File-extension-and-supported-formats)\r\n* [Passing custom parameters](https://github.com/continuum/active_importer/wiki/Custom-parameters)\r\n* [Events and callbacks](https://github.com/continuum/active_importer/wiki/Callbacks)\r\n* [Selecting the model instance to import into (Update instead of create)](https://github.com/continuum/active_importer/wiki/Update-instead-of-create)\r\n* [Error handling](https://github.com/continuum/active_importer/wiki/Error-handling)\r\n* [Selecting the sheet to get data from](https://github.com/continuum/active_importer/wiki/Selecting-the-sheet-to-work-with)\r\n* [Skipping rows](https://github.com/continuum/active_importer/wiki/Skipping-rows)\r\n\r\n### Advanced features\r\n\r\n* [Aborting the import process](https://github.com/continuum/active_importer/wiki/Aborting-the-import-process)\r\n* [Transactional importers](https://github.com/continuum/active_importer/wiki/Transactional-importers)\r\n\r\n## Contributing\r\n\r\nContributions are welcome! Take a look at our [contributions guide](https://github.com/continuum/active_importer/wiki/Contributing) for details.\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}